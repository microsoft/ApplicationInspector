[
  {
    "name": "Data: Serialization",
    "id": "AI012100",
    "description": "Data: Serialization",
    "applies_to": [
      "python",
      "rust"
    ],
    "tags": [
      "Data.Serialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "#\\[derive\\(.*Serialize.*\\)]|serde::Serialize",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ],
    "must-match": [
      "#[derive(Debug, Serialize, Deserialize)]",
      "use serde::Serialize;",
      "#[derive(Serialize)]"
    ],
    "must-not-match": [
      "// Serialize the data to JSON",
      "def serialize_data(obj):",
      "class MySerializer: pass"
    ]
  },
  {
    "name": "Data: Serialization",
    "id": "AI012200",
    "description": "Data: Serialization",
    "applies_to": [
      "python"
    ],
    "tags": [
      "Data.Serialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "^\\s*import\\s+(?:c)?pickle\\s*$|^\\s*from\\s+(?:c)?pickle\\s+import",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ],
    "must-match": [
      "import pickle",
      "import cpickle",
      "from pickle import dumps, loads",
      "from cpickle import dump"
    ],
    "must-not-match": [
      "import my_pickle_wrapper",
      "# import pickle for serialization",
      "from utils.pickle_helper import serialize"
    ]
  },
  {
    "name": "Data: Serialization",
    "id": "AI012300",
    "description": "Data: Serialization",
    "applies_to": [
      "python"
    ],
    "tags": [
      "Data.Serialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "c?pickle\\.dump",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI012400",
    "description": "Data: Deserialization",
    "applies_to": [
      "python"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "c?pickle\\.load",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI012500",
    "description": "Data: Deserialization",
    "applies_to": [
      "java"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": ".readObject",
        "type": "Substring",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI012600",
    "description": "Data: Deserialization",
    "applies_to": [
      "php"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "unserialize\\(",
        "type": "Substring",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI012700",
    "description": "Data: Deserialization",
    "applies_to": [
      "ruby"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "(YAML|Syck|Marshal)\\.load",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Serialization",
    "id": "AI012800",
    "description": "Data: Serialization",
    "applies_to": [
      "csharp"
    ],
    "tags": [
      "Data.Serialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "SerializeObject|JavaScriptSerializer|Newtonsoft|json\\.net|Utf8Json|MessagePack",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI012900",
    "description": "Data: Deserialization",
    "applies_to": [
      "csharp"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "DeserializeObject",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "PopulateObject",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "TypeNameHandling",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "(De)?[Ss]erialize",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI013000",
    "description": "Data: Deserialization",
    "applies_to": [
      "csharp"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "System.Runtime.Serialization",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "BinaryFormatter",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "TypeNameHandling",
        "type": "String",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      }
    ]
  },
  {
    "name": "Data: Deserialization",
    "id": "AI013010",
    "description": "Data: Deserialization",
    "applies_to": [
      "python",
      "rust"
    ],
    "tags": [
      "Data.Deserialization"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "#\\[derive\\(.*Deserialize.*\\)]|serde::Deserialize|from_str\\(|parse\\(",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "#[derive(Debug, Deserialize)]",
      "use serde::Deserialize;",
      "let value: MyType = serde_json::from_str(json_str)?;",
      "let num = s.parse();"
    ],
    "must-not-match": [
      "// Deserialize JSON data",
      "def deserialize(data):",
      "class MyDeserializer: pass"
    ]
  },
  {
    "name": "Data: Bluetooth Serialization",
    "id": "AI013100",
    "description": "Data: Bluetooth Serialization",
    "tags": [
      "Data.Deserialization.Signal.Bluetooth"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "BluetoothAdapter|BluetoothDevice|BluetoothGatt|BluetoothSocket|CBCentralManager|CBPeripheral",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "\\bbluetooth\\b",
        "type": "Regex",
        "modifiers": [
          "i"
        ],
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter();",
      "var device = new BluetoothDevice();",
      "CBCentralManager *manager = [[CBCentralManager alloc] init];",
      "const bluetooth = require('bluetooth-serial-port');"
    ],
    "must-not-match": [
      "var has_bluetooth_support = false;",
      "String bluetooth_disabled = 'error';"
    ]
  },
  {
    "name": "Data: Cellular Serialization",
    "id": "AI013200",
    "description": "Data: Cellular Serialization",
    "tags": [
      "Data.Deserialization.Signal.Cellular"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "CTTelephonyNetworkInfo|CTCarrier|TelephonyManager|CellInfo",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "\\bcellular\\b",
        "type": "Regex",
        "modifiers": [
          "i"
        ],
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "TelephonyManager telMgr = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE);",
      "CTTelephonyNetworkInfo *netInfo = [[CTTelephonyNetworkInfo alloc] init];",
      "List<CellInfo> cellInfos = telephonyManager.getAllCellInfo();",
      "const cellular = networkInfo.cellular;"
    ],
    "must-not-match": [
      "var cellular_enabled = false;",
      "String cellular_provider = 'Verizon';"
    ]
  },
  {
    "name": "Data: USB",
    "id": "AI013300",
    "description": "Data: USB Serialization",
    "tags": [
      "Data.Deserialization.Signal.USB"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "USBDevice|UsbManager|UsbAccessory|IOUSBDeviceInterface|libusb",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "\\bUSB\\b",
        "type": "Regex",
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "UsbManager manager = (UsbManager)getSystemService(Context.USB_SERVICE);",
      "const device = new USBDevice();",
      "IOUSBDeviceInterface **deviceInterface;",
      "import libusb"
    ],
    "must-not-match": [
      "var usb_enabled = false;",
      "String usb_port_name = 'COM1';"
    ]
  },
  {
    "name": "Data: Ethernet",
    "id": "AI013400",
    "description": "Data: Ethernet Serialization",
    "tags": [
      "Data.Deserialization.Signal.Ethernet"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "EthernetClient|EthernetServer|NetworkInterface|getifaddrs|pcap",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "\\bethernet\\b",
        "type": "Regex",
        "modifiers": [
          "i"
        ],
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "EthernetClient client;",
      "NetworkInterface[] interfaces = NetworkInterface.GetAllNetworkInterfaces();",
      "if (getifaddrs(&ifaddr) == -1) { }",
      "const ethernet = new EthernetServer(80);"
    ],
    "must-not-match": [
      "var ethernet_connected = false;",
      "String ethernet_mac = '00:11:22:33:44:55';"
    ]
  },
  {
    "name": "Data: Modem",
    "id": "AI013500",
    "description": "Data: Modem Serialization",
    "tags": [
      "Data.Deserialization.Signal.Modem"
    ],
    "severity": "Critical",
    "patterns": [
      {
        "pattern": "ModemManager|ATCommand|SerialPort|TAPI",
        "type": "RegexWord",
        "scopes": [
          "Code"
        ],
        "confidence": "High"
      },
      {
        "pattern": "\\bmodem\\b",
        "type": "Regex",
        "modifiers": [
          "i"
        ],
        "scopes": [
          "Code"
        ],
        "confidence": "Medium"
      }
    ],
    "must-match": [
      "ModemManager *manager = modem_manager_new();",
      "SerialPort port = new SerialPort(\"COM1\");",
      "sendATCommand(\"AT+CGMI\");",
      "const modem = require('modem-js');"
    ],
    "must-not-match": [
      "var modem_enabled = false;",
      "String modem_vendor = 'Qualcomm';"
    ]
  }
]